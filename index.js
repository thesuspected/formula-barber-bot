import dotenv from 'dotenv'
import { Telegraf } from 'telegraf'
import { getMainKeyboard, getFeedbackKeyboard } from './keyboards.js'
import { CMD, FB_BUTTONS } from './const.js'

dotenv.config()
const { BOT_TOKEN } = process.env
const bot = new Telegraf(BOT_TOKEN)

bot.start((ctx) =>
    ctx.replyWithHTML(
        `–ü—Ä–∏–≤–µ—Ç, ${ctx.from.first_name}!

–ù–∞ —Å–≤—è–∑–∏ –§–æ—Ä–º—É–ª–∞ –ë–∞—Ä–±–µ—Ä—à–æ–øüíà‚Äî —Ç–≤–æ–π –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ –≤ –º–∏—Ä —Å—Ç–∏–ª—å–Ω—ã—Ö —Å—Ç—Ä–∏–∂–µ–∫ üíá‚Äç‚ôÇÔ∏è

–í –±–æ—Ç–µ —Ç—ã –º–æ–∂–µ—à—å –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∫ –ª—é–±–∏–º–æ–º—É –º–∞—Å—Ç–µ—Ä—É, –∫–æ–ø–∏—Ç—å –±–æ–Ω—É—Å—ã, –ø–æ–ª—É—á–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –∏ –µ—â–µ –º–Ω–æ–≥–æ —á–µ–≥–æ –ø–æ–ª–µ–∑–Ω–æ–≥–æ –ø–æ –∫–Ω–æ–ø–∫–∞–º –≤–Ω–∏–∑—É ‚¨áÔ∏è

–ú—ã –æ—á–µ–Ω—å —Ä–∞–¥—ã –Ω–æ–≤—ã–º –≥–æ—Å—Ç—è–º, –ø—Ä–∏–≥–ª–∞—à–∞–π –¥—Ä—É–∑–µ–π –∏ –ø–æ–ª—É—á–∞–π —Å–∫–∏–¥–∫—É üéÅ

–¢–∞–∫–∂–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –Ω–∞ –Ω–∞—à–∏ —Å–æ—Ü—Å–µ—Ç–∏, —á—Ç–æ–±—ã –±—ã—Ç—å –≤ –∫—É—Ä—Å–µ –≤—Å–µ—Ö –∞–∫—Ü–∏–π –∏ —Å–æ–±—ã—Ç–∏–π: inst, tg`,
        getMainKeyboard()
    )
)

// –°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–∏–π –∞–∫–∫ –∞–¥–º–∏–Ω–∞
bot.hears(CMD.ADMIN, (ctx) =>
    ctx.replyWithHTML(
        `–ü–æ –≤–æ–ø—Ä–æ—Å–∞–º –∑–∞–ø–∏—Å–∏ –∏ —Ä–∞–±–æ—Ç—ã –±–∞—Ä–±–µ—Ä—à–æ–ø–∞ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –≤ –∞–∫–∫–∞—É–Ω—Ç <a href="https://t.me/formula_barber">formula_barber</a>`
    )
)

// –ê–¥—Ä–µ—Å
bot.hears(CMD.ADDRESS, (ctx) =>
    ctx.replyWithHTML(`–ú—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ–º—Å—è –ø–æ –∞–¥—Ä–µ—Å—É <a href="https://yandex.ru/maps/-/CDrTB2Ll">–ß–µ—Ä–Ω—ã—à–µ–≤—Å–∫–æ–≥–æ 52–ë</a>`)
)

// –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ - –í–æ–∑–≤—Ä–∞—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
bot.hears(CMD.FEEDBACK, (ctx) =>
    ctx.replyWithHTML('–û—Å—Ç–∞–≤—å—Ç–µ –æ—Ç–∑—ã–≤ –æ –Ω–∞—Å –ø–æ –æ–¥–Ω–æ–π –∏–∑ —Å—Å—ã–ª–æ–∫ –∏–ª–∏ –∞–Ω–æ–Ω–∏–º–Ω–æ –ø–æ –∫–Ω–æ–ø–∫–µ', getFeedbackKeyboard())
)

// –û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤ - –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "–ê–Ω–æ–Ω–∏–º–Ω–æ"
bot.action(FB_BUTTONS.ANONIM, (ctx) =>
    ctx.replyWithHTML(
        '–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–≤–µ—Ç–æ–º –Ω–∞ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–∞—à–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ, –æ–Ω–æ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–Ω–æ–Ω–∏–º–Ω–æ, –º—ã —É—á—Ç–µ–º –≤—Å–µ –≤–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∏ –∑–∞–º–µ—á–∞–Ω–∏—è'
    )
)

bot.launch()
console.log('–±–æ—Ç –∑–∞–ø—É—â–µ–Ω')

// –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
process.once('SIGINT', () => bot.stop('SIGINT'))
process.once('SIGTERM', () => bot.stop('SIGTERM'))
